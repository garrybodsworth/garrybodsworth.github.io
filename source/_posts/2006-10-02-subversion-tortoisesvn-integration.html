---
layout: post
title: "Subversion : TortoiseSVN Integration into Visual Studio"
date: 2006-10-02T09:35:00+00:00
categories:
 - Visual Studio 2005
 - TortoiseSVN
 - Subversion
 - Integration
alias: /2006/10/subversion-tortoisesvn-integration.html
---

<div class='post'>
<span style="font-weight:bold;"><a href="http://garrys-brain.blogspot.com/2007/07/tortoisesvn-and-visual-studio.html">See the update here.</a></span><br /><br />This is the easy method of integrating <a href="http://www.tortoisesvn.net">TortoiseSVN</a> into Visual Studio.NET 2003 and 2005 (and probably Visual Studio 6.0).  I'll take it in stages first and show you how to add these useful things to your "External Tools" menu.<br /><br />TortoiseSVN is kind enough to provide a decent command-line interface for bringing up the dialogs.  This gives us the ability to add External Tools that will operate on the currently open project in Visual Studio.<br /><br />Here is a script (vbs) that will append the External Tools to the end of your list:<br /><table style="font-size:75%;border: 1px dashed #2f6fab; background-color: #f9f9f9;"><tr><td><pre>'<br />' Create the Subversion External Tools for Visual Studio<br />'<br /><br />' Set the Visual Studio Version Number so we access the correct<br />' part of the registry for External Tools.<br />' Visual Studio.NET      = "7.0"<br />' Visual Studio.NET 2003 = "7.1"<br />' Visual Studio.NET 2005 = "8.0"<br />Dim strVisualStudioVersionNumber<br />strVisualStudioVersionNumber = "8.0"<br /><br />Dim strTortoiseSVNBin<br />strTortoiseSVNBin = "c:\\program files\\TortoiseSVN\\bin\\"<br /><br />' Create the scripting shell object<br />Dim WshShell<br />Set WshShell = WScript.CreateObject("WScript.Shell")<br /><br />' Function to install an external tool<br />function WriteExternalTool( strVersionNumber, _<br />    iToolNumber, _<br />    strTitle, _<br />    strCommandLine, _<br />    strArgs, _<br />    strWorkingDir, _<br />    strSource, _<br />    strOptions)<br /> ' NOTES (from Google Groups):<br /> ' ToolTitle<your tool number>:<br /> '   stores the name of your tool<br /> ' ToolCmd<your tool number>:<br /> '   stores the path to your tool<br /> ' ToolArg<your tool number>: <br /> '   stores the command line arguments for your tool.<br /> '   Set this to a blank string if your tool takes no arguments.<br /> ' ToolDir<your tool number>:<br /> '   stores the initial directory from which your tool<br /> '   should be run.  Set this to a blank string if you don't care where your tool<br /> '   is run from.<br /> ' ToolOpt<your tool number>:<br /> '   stores the settings for the checkboxes at the<br /> '   bottom of the external tools dialog.  The easiest way to determine what<br /> '   value you should set, is to create your tool once manually with the<br /> '   checkboxes set the way you like, and then exit visual studio.  Then look up<br /> '   the value that's written to this regkey.  The value that this registry<br /> '   entries got set to is the value your installer should set. <br /> <br /> Dim strTitleKey, strCommandLineKey, strArgsKey, strWorkingDirKey, strSourceKey, strOptionsKey<br /> ' Construct the keys we will be adding to as strings.  These depend on the number of the tool.<br /> strTitleKey =  "HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\" & _<br />     strVersionNumber & "\External Tools\ToolTitle" & iToolNumber<br /> strCommandLineKey = "HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\" & _<br />     strVersionNumber & "\External Tools\ToolCmd" & iToolNumber<br /> strArgsKey =  "HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\" & _<br />     strVersionNumber & "\External Tools\ToolArg" & iToolNumber<br /> strWorkingDirKey = "HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\" & _<br />     strVersionNumber & "\External Tools\ToolDir" & iToolNumber<br /> strSourceKey =  "HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\" & _<br />     strVersionNumber & "\External Tools\ToolSourceKey" & iToolNumber<br /> strOptionsKey =  "HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\" & _<br />     strVersionNumber & "\External Tools\ToolOpt" & iToolNumber<br /> <br /> ' Write out the contents of an external tool <br /> WshShell.RegWrite strTitleKey, strTitle<br /> WshShell.RegWrite strCommandLineKey, strCommandLine<br /> WshShell.RegWrite strArgsKey, strArgs<br /> WshShell.RegWrite strWorkingDirKey, strWorkingDir<br /> WshShell.RegWrite strSourceKey, strSource<br /> WshShell.RegWrite strOptionskey, strOptions, "REG_DWORD"<br /><br /> ' Update the count of external tools for the benefit of Visual Studio<br /> WshShell.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\" & _<br />     strVersionNumber & _<br />     "\External Tools\ToolNumKeys", _<br />    iToolNumber + 1, _<br />    "REG_DWORD"<br /> <br /> WriteExternalTool = (iToolNumber + 1)<br />end function<br /><br />' Get the number of current external tools as this will tell us where to start the numbering<br />Dim iNumTools<br />iNumTools = WshShell.RegRead( "HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\" & _<br />    strVisualStudioVersionNumber & _<br />    "\External Tools\ToolNumKeys")<br /><br />' Install Subversion Tools<br /><br />' The order is:<br />'   SVN Commit<br />'   SVN Update<br />'   SVN History<br />'   SVN Diff<br />'   SVN Blame<br />'   SVN Revert<br />'   SVN Modifications<br />'   SVN Repository<br />'   SVN Project History<br />'   SVN Settings<br /><br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Commit", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:commit /path:""$(SolutionDir)"" /notempfile", _<br />    "$(SolutionDir)", _<br />    "", _<br />    17)<br /><br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Update", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:update /path:""$(SolutionDir)"" /notempfile", _<br />    "$(SolutionDir)", _<br />    "", _<br />    17)<br />    <br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN History", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:log /path:""$(ItemPath)"" /notempfile", _<br />    "$(ItemDir)", _<br />    "", _<br />    17)<br />    <br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Diff", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:diff /path:""$(ItemPath)"" /notempfile", _<br />    "$(ItemDir)", _<br />    "", _<br />    17)<br /><br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Blame", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:blame /path:""$(ItemPath)"" /notempfile", _<br />    "$(ItemDir)", _<br />    "", _<br />    17)<br /><br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Revert", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:revert /path:""$(SolutionDir)"" /notempfile", _<br />    "$(SolutionDir)", _<br />    "", _<br />    17)<br /><br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Modifications", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:repostatus /path:""$(SolutionDir)"" /notempfile", _<br />    "$(SolutionDir)", _<br />    "", _<br />    17)<br /><br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Repository", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:repobrowser /path:""$(SolutionDir)"" /notempfile", _<br />    "$(SolutionDir)", _<br />    "", _<br />    17)<br /><br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Project History", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:log /path:""$(SolutionDir)"" /notempfile", _<br />    "$(SolutionDir)", _<br />    "", _<br />    17)<br /><br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Settings", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:settings /path:""$(SolutionDir)"" /notempfile", _<br />    "$(SolutionDir)", _<br />    "", _<br />    17)<br /><br />' Reset the scripting shell object<br />set WshShell = nothing</pre></td></tr></table><br /><a href="http://garry.bodsworth.googlepages.com/SubversionInstall.zip">Download the script from this link</a><br /><br />You can set your Visual Studio version by setting the <span style="font-style: italic;">strVisualStudioVersionNumber</span> variable according to the comment.<br /><br />If your TortoiseSVN is not in the default installation location change the <span style="font-style: italic;">strTortoiseSVNBin </span>variable (making sure you use \\ as separators).<br /><br />I am not a vbs expert but I tried to make this script as reusable as possible, especially with respect to writing the external tools to the registry.  This should work with any external tools you may want to add via this script.  There are probably some TortoiseSVN features that should be added as well, but I have got by on what is in that script so far.<br /><br />For the next part I will describe how to make a toolbar to access the new External Tools.</div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Adi</div>
<div class='content'>
<a rel="external" href="http://orientinspiration.com/2009/09/oes-tsetnoc.html" rel="nofollow">Oes  Tsetnoc</a> one of the ways in which we can learn seo besides <a rel="external" href="http://duniasoer.com/archives/mengembalikan-jati-diri-bangsa.html" rel="nofollow">Mengembalikan Jati Diri Bangsa</a>.  By participating in the <a rel="external" href="http://mncmakina.com/2009/09/oes-tsetnoc-seo-contest/" rel="nofollow">Oes Tsetnoc</a> or <a rel="external" href="http://ulaznice.info/mengembalikan-jati-diri-bangsa.html" rel="nofollow">Mengembalikan Jati Diri Bangsa</a> we can improve our seo skills. To find more information about <a rel="external" href="http://catatanblogger.info/738688-Oes-Tsetnoc.html" rel="nofollow">Oest Tsetnoc</a> please visit my <a rel="external" href="http://kusukaseo.info/981750-Oes-Tsetnoc-Support.html" rel="nofollow">Oes Tsetnoc</a> pages. And to find more information about <a rel="external" href="http://duniasoer.com" rel="nofollow">Mengembalikan Jati Diri Bangsa</a> please visit my <a rel="external" href="http://catatanblogger.info/464655-Mengembalikan-Jati-Diri-Bangsa.html" rel="nofollow">Mengembalikan Jati Diri Bangsa</a> pages. Thank you So much.</div>
</div>
</div>
