
<!DOCTYPE HTML>
<html lang="en-gb">
<head>
  <meta charset="UTF-8">
  <title>Fragmented Memory</title>

  <meta name="author" content="Garry Bodsworth">
  
  <meta name="description" content="A Bit of Hardcore Programming Dec 11th, 2006 Last week Slashdot drew attention to an article about the origin of the fast approximation of the &hellip;">
  
  

  <link rel="canonical" href="http://www.fragmentedmemory.com/blog/2006/12/11/bit-of-hardcore-programming">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/feed/" rel="alternate" title="Fragmented Memory" type="application/atom+xml">
</head>
  
<body class="default">
  <div id="wrapper">
    <div id="header">
  <h1><a href="/">Fragmented Memory</a></h1>
  
    <p>Garry Bodsworth's Blog (formerly Garry's Bit Patterns &amp; Programmer's Log)</p>
  
</div>
<ul id="social-links">
  
    <li><a class="rss" href="/feed/" title="RSS">RSS</a></li>
  
  
  
  
    <li><a class="twitter" href="http://twitter.com/garrybodsworth" title="Twitter">Twitter</a></li>
  
  
    <li><a class="github" href="https://github.com/garrybodsworth" title="GitHub">GitHub</a></li>
  
  
  
  
  
  
    <li><a class="pinboard" href="https://pinboard.in/u:garrybodsworth" title="Pinboard">Pinboard</a></li>
  
</ul>
<div class="clear"></div>
<ul id="nav">
  
    <li> <a href="/">blog</a> </li>
  

  
    <li><a href="/blog/archives">archives</a></li>
  

  
    <li><a href="/about">about</a></li>
  
</ul>

    <div id="main"> <div class="post-header">
  
    <h1 class="post-title">A Bit of Hardcore Programming</h1>
  
  








  


<time datetime="2006-12-11T18:51:00+00:00" pubdate data-updated="true">Dec 11<span>th</span>, 2006</time>
</div>

<div class="post-content"><div class='post'>
Last week <a href="http://games.slashdot.org/article.pl?sid=06/12/01/184205">Slashdot</a> drew attention to an article about <a href="http://www.beyond3d.com/articles/fastinvsqrt/">the origin of the fast approximation of the inverse square root in Quake 3</a>.  For anyone who likes obscure bits of code it is really quite interesting and I think really understanding the code does make you a better programmer even if you never use it.<blockquote><br />float InvSqrt (float x) {<br />float xhalf = 0.5f*x;<br />int i = *(int*)&x;<br />i = 0x5f3759df - (i>>1);<br />x = *(float*)&i;<br />x = x*(1.5f - xhalf*x*x);<br />return x;<br />}</blockquote>It computes the result using integer maths instead of floating point operations because back in the day that was faster.  This function does the operation to an approximation which is fine when it is used in graphics where the human eye finds it impossible to differentiate small changes in colour.  It is one of those functions where the more you iterate the more accurate the result it.<br /><br />It works by reinterpreting the float bit pattern as an integer then using bit shifting to get at the mantissa.  The &#8220;magic seed value&#8221; is an approximation of the result (it is easier to get a good approximation when the result is in a mostly predictable range).<br /><br />Anyway a useful tome about this kind of trickery is <a href="http://en.wikipedia.org/wiki/HAKMEM">HACKMEM</a>, you can read it online <a href="http://home.pipeline.com/~hbaker1/hakmem/hakmem.html">here</a>.<br /><br />It would also be a good idea to check out <a href="http://www.hackersdelight.org/">Hacker&#8217;s Delight</a>.</div>
</div>


<div class="post-single">
  <div class="post-meta">
    

<span class="categories">
  Categories:
  
    <a class='category' href='/blog/categories/c/'>C</a>, <a class='category' href='/blog/categories/development/'>Development</a>
  
</span>


    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://www.fragmentedmemory.com/blog/2006/12/11/bit-of-hardcore-programming/" data-via="garrybodsworth" data-counturl="http://www.fragmentedmemory.com/blog/2006/12/11/bit-of-hardcore-programming/" >Tweet</a>
  
  
  
</div>

    
  </div>
  <div class="clear"></div>

  
</div>
 </div>
    <div id="footer">
  <div class="panels">
    <div class="license">
      <h2>License</h2>
      <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>.
    </div>

    <div class="posts">
      <h2>Recent Posts</h2>
      <ul>
        
          <li>
            <a href="/blog/2013/06/18/new-location-and-new-blog-engine-and-old-content-restored/">New Location &amp; New Blog Engine &amp; Old Content Restored</a>
          </li>
        
          <li>
            <a href="/blog/2013/06/13/joining-microsoft/">Joining Microsoft</a>
          </li>
        
          <li>
            <a href="/blog/2013/06/13/leaving-bromium/">Leaving Bromium</a>
          </li>
        
          <li>
            <a href="/blog/2013/03/05/philip-su-engineering-process-and/">Philip Su - Engineering Process And Philosophy At Facebook</a>
          </li>
        
          <li>
            <a href="/blog/2013/03/05/more-creator-owned-comics-genocide/">More Creator-Owned Comics - Genocide: Duostar</a>
          </li>
        
      </ul>
    </div>
  </div>

  <p class="powered">
    Powered by <a href="http://octopress.org">Octopress</a> and <a href="https://github.com/iwinux/compbits">Compbits</a>
  </p>
</div>

  </div> <!-- #wrapper end -->

  

  


  

  

  
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


</body>
</html>
