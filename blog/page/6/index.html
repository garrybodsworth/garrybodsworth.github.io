
<!DOCTYPE HTML>
<html lang="en-gb">
<head>
  <meta charset="UTF-8">
  <title>Fragmented Memory</title>

  <meta name="author" content="Garry Bodsworth">
  
  <meta name="description" content="The Many Faces of WebKit Apr 29th, 2010 I&#8217;ve been back into the belly of the beast investigating different implementations of WebKit again. So &hellip;">
  
  

  <link rel="canonical" href="http://www.fragmentedmemory.com/blog/page/6">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/feed/" rel="alternate" title="Fragmented Memory" type="application/atom+xml">
</head>
  
<body class="default">
  <div id="wrapper">
    <div id="header">
  <h1><a href="/">Fragmented Memory</a></h1>
  
    <p>Garry Bodsworth's Blog (formerly Garry's Bit Patterns &amp; Programmer's Log)</p>
  
</div>
<ul id="social-links">
  
    <li><a class="rss" href="/feed/" title="RSS">RSS</a></li>
  
  
  
  
    <li><a class="twitter" href="http://twitter.com/garrybodsworth" title="Twitter">Twitter</a></li>
  
  
    <li><a class="github" href="https://github.com/garrybodsworth" title="GitHub">GitHub</a></li>
  
  
  
    <li><a class="linkedin" href="http://www.linkedin.com/in/garrybodsworth">LinkedIn</a></li>
  
  
  
  
    <li><a class="pinboard" href="https://pinboard.in/u:garrybodsworth" title="Pinboard">Pinboard</a></li>
  
</ul>
<div class="clear"></div>
<ul id="nav">
  
    <li> <a href="/" class="current">blog</a> </li>
  

  
    <li><a href="/blog/archives">archives</a></li>
  

  
    <li><a href="/about">about</a></li>
  
</ul>

    <div id="main"> 

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2010/04/29/the-many-faces-of-webkit/">The Many Faces of WebKit</a>
    </h1>
  
  








  


<time datetime="2010-04-29T00:00:00+01:00" pubdate data-updated="true">Apr 29<span>th</span>, 2010</time>
</div>

<div class="post-content"><p>I&#8217;ve been back into the belly of the beast investigating different implementations of WebKit again. So I thought I&#8217;d share some of the things I picked up about them.</p>

<p>Obviously the Apple implementation is the cream of the crop for speed an features. In fact the Mac OSX version isn&#8217;t top of the tree, it&#8217;s the <a href="http://www.satine.org/archives/2008/11/06/coverflow-for-safari-on-iphone/">iPhone/iPad version</a> that has been furthest ahead. It got the accelerated compositing of web elements first and could do all kinds of funky 3D transforms using OpenGL. The OS X version got those features only in the <a href="http://www.satine.org/archives/2009/07/11/snow-stack-is-here/">middle of last year</a>.</p>

<p>Other ports vary in stability, features and usefulness.</p>

<p><a href="http://www.webkitgtk.org/">WebkitGTK</a><br/>
This is the port of WebKit to the GTK+ widget set. It has been through a lot of changes like where the network backend moved to a new library which meant that proxies could not work for a fair while. The rendering itself uses Cairo (good stuff), but it is just a shame you can&#8217;t easily switch backend (like swapping from xlib to opengl). It uses Pango for font rendering which I know is very good, but it has a serious limitation, it can&#8217;t load temporary fonts directly from a file, this means that the new font-face features in HTML will be a long way off.</p>

<p><a href="http://trac.webkit.org/wiki/QtWebKit">QtWebKit</a><br/>
The rendering quality does look seriously good, but as usual with Qt I am finding very bad performance metrics. I&#8217;ve tried changing rendering backends where &#8220;native&#8221; seems to perform best and &#8220;opengl&#8221; fails then segfaults (which is even more surprising when you consider I am using the nvidia binary drivers on Linux which are pretty full featured).</p>

<p>HTML5support seems a bit flaky at best with one of my sample set completely freezing the process. On the plus side there is integration work already done for compositing, and fonts look seriously good. I got Flash working and it seems OK, but not quite as fast as WebkitGTK.</p>

<p>The biggest advantage though is <a href="http://www.pyside.org/">PySide</a> which are comprehensive generated Python bindings for Qt. It allowed me to a do a very quick integration with the gobject mainloop in Python as well.</p>

<p>They have also broken away from the protracted Qt release process which allow them to release WebKit features much faster. This makes life a lot easier and they are allowing targetting of more than one version (although not officially supported).</p>

<p><a href="http://trac.webkit.org/wiki/EFLWebKit">EFL Webkit</a><br/>
I have a soft spot for EFL and <a href="http://www.enlightenment.org/">Enlightenment</a>, it gets a lot of the basics very right (small reusable components and fast and low footprint). EFL Webkit shares a majority of infrastructure with GTK including the Cairo rendering and network backend. The project has also recently picked up sponsorship from Samsung.</p>

<p>There is a really cool demo of the web browser being drawn on a 3D surface using the EFL libraries. You can see it <a href="http://blog.gustavobarbieri.com.br/2009/11/04/evas-uv-mapping-and-webkit-efl/">here</a>. It&#8217;s got gstreamer integration for HTML5 video and plugin support for Flash (oh well).</p>

<p>Now that just covers those main ones available on Linux. There is still the <a href="http://opensource.palm.com/1.4.1.1/index.html">Palm WebOS</a> version, Blackberry, <a href="http://www.sand-labs.org/owb">OWB</a>, and tons more. OWB looks the simplest for enabling porting to new platforms and I have built the SDL version in the past. Then there is the Windows version of WebKit and the standalone Mac build&#8230;</p>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2010/04/28/binary-blobs/">Binary Blobs&#8230;</a>
    </h1>
  
  








  


<time datetime="2010-04-28T00:00:00+01:00" pubdate data-updated="true">Apr 28<span>th</span>, 2010</time>
</div>

<div class="post-content"><p>I discovered a way to consistently crash xorg using the nvidia driver.  Open webkitgtk, close it, wait fiver seconds, open it again, rinse and repeat for 15 minutes.  Boom xorg explodes.  Go look at the logs and you have a stack trace telling you something went wrong. As far as I can tell it is running out of texture memory. Bizarrely it doesn&#8217;t do this for videos.</p>

<p>The nvidia driver itself is really quite good in the grand scheme of things providing things like tear-less, hardware accelerated video. It&#8217;s still more consistent and better quality than the open-source ones (obviously owning all the IP and information helps).</p>

<p>But this is the problem with binary blobs you can&#8217;t tell what is going on inside until the state is spat out in the event of failure. I generated the bug report using the nvidia supplied tool and looked at it myself, and there was no information in there that would give a clue as to why. If the internals were exposed you could look at where the memory was going like in the days of <a href="http://blog.programmerslog.com/?p=367">GEM memory leaks on Intel</a>.</p>

<p>I guess open-source has its own set of advantages and limitations, as well as the closed-source approach, but damn, I hate losing many hours trying to at first reproduce then diagnose it, let alone being able to make an attempt to fix it.</p>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2010/04/25/unicomics-2010/">Unicomics 2010</a>
    </h1>
  
  








  


<time datetime="2010-04-25T00:00:00+01:00" pubdate data-updated="true">Apr 25<span>th</span>, 2010</time>
</div>

<div class="post-content"><p>Yesterday at the University of Hertfordshire was the first <a href="http://www.unicomics.co.uk/UniComics/Unicon.html">Unicon</a> &#8211; the <a href="http://www.unicomics.co.uk/UniComics/UniComics_Home.html">Unicomics</a> Comic Convention organised by <a href="http://www.dannygraydon.com/2010/03/coming-soon-unicomics/">Danny Graydon</a>. It is the closest comic event to Cambridge I can think of, and it was jam packed with the cream of small-press creators.</p>

<p>So I spent the day strolling around spending money on small press comics and going to panels. Unfortunately the panels I went to were very sparsely attended, but that meant they were more entertaining and interactive.</p>

<p>I thought I&#8217;d do a list of the creator&#8217;s work I picked up since they all produce such fantastic work (and they all have tasters online):</p>

<ul>
<li><a href="http://massacreforboys.blogspot.com/">Steve and Chris Denton&#8217;s Massacre and Walking Wounded</a> &#8211; The original zombie nazis comic.  Great art and entertainment.</li>
<li><a href="http://www.strip-for-me.com/">Doug Noble&#8217;s Complex</a> &#8211; which is about scientists trapped in a scientific complex at the end of the world.</li>
<li><a href="http://www.modernmonstrosity.moonfruit.com/#/shop/4537202010">Oliver Lambden&#8217;s Bloc</a> &#8211; a silent story filtered through the best of bande desinee.</li>
<li><a href="http://www.necessarymonsters.com/">Daniel Goodbrey and Sean Azzopardi&#8217;s Necessary Monsters</a> &#8211; Monsters and secret agencies.</li>
<li><a href="http://www.pbrainey.com/tntltp.htm">Paul Rainey&#8217;s There&#8217;s No Time Like The Present</a></li>
<li><a href="http://angrycandy.co.uk/">Andrew Cheverton and Tim Keable&#8217;s West: Justice</a> &#8211; A beautiful hardcover western book</li>
<li><a href="http://www.webcomicsnation.com/joedecie/">Joe Decie&#8217;s What I Drew</a> &#8211; Truth and lies in comics form</li>
<li><a href="http://notregret.com/jambo/">George Beedham&#8217;s Jambo</a> &#8211; The UK&#8217;s premiere jam based superhero.</li>
<li><a href="http://wearewordsandpictures.com/">Paper Science</a> &#8211; It&#8217;s newspaper shaped but full of comics.</li>
</ul>


<p>Fingers crossed there is another one of these events next year, it was very well organised and deserves a bigger turnout.</p>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2010/04/25/start-me-up/">Start Me Up</a>
    </h1>
  
  








  


<time datetime="2010-04-25T00:00:00+01:00" pubdate data-updated="true">Apr 25<span>th</span>, 2010</time>
</div>

<div class="post-content"><p>This may turn out to be one of those hollow promises again, but I am going to get this blog up and running again even if it kills me. The baby is sleeping (and snoring) upstairs so I have time, unless I am forced to do cleaning.</p>

<p>So what is new? <a href="http://www.camvine.com">Camvine</a> did fill those vacancies with some good guys. I was surprised to hear some people even heard about it form this humble page.</p>

<p>What I need to do now though is try and get some Python changes merged upstream. I have been beating the networking code in urllib2 and httplib (two completely separate yet hopelessly intertwined) modules actually working. This means fixing HTTPS, digest proxy authentication, in fact proxy authentication, and tons more subtle interactions (like passing on CONNECT requests).</p>

<p>Strangely prescient was the article <a href="http://jessenoller.com/2010/04/22/why-arent-you-contributing-to-python/">Why Aren&#8217;t You Contributing To Python</a> since I have worked out all these fixes. I think the order will need to be 1) write lots of tests 2) get a number of small patches 3) cross reference it all with the python bug tracker. And this is all only in 2.6.4 currently.</p>

<p>And this year I will be going to <a href="http://www.europython.eu/">Europython</a> and aiming to not get serious food poisoning again&#8230;</p>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2010/02/24/bizarre-journey-to-the-sun/">Bizarre Journey to the Sun</a>
    </h1>
  
  








  


<time datetime="2010-02-24T00:00:00+00:00" pubdate data-updated="true">Feb 24<span>th</span>, 2010</time>
</div>

<div class="post-content"><p>You never know quite where you are going to end up, for me I ended up in The Sun newspaper today for the launch of a new website <a href="http://www.bestcourse4me.com/">bestcourse4me</a>. It is a website to help students decide their future.</p>

<p>You can see my ugly mug <a href="http://www.thesun.co.uk/sol/homepage/features/2866157/Education-under-Labour-day-2-Trevor-Kavanaghs-blistering-verdict.html">here</a> on the right hand side.</p>

<p>Quentin also has a more in-depth look at the site <a href="http://www.statusq.org/archives/2010/02/24/2739/?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+statusq+%28Status-Q%29&amp;utm_content=Google+Reader">here</a>.</p>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2009/12/08/camvine-is-hiring/">Camvine Is Hiring</a>
    </h1>
  
  








  


<time datetime="2009-12-08T00:00:00+00:00" pubdate data-updated="true">Dec 8<span>th</span>, 2009</time>
</div>

<div class="post-content"><p>At <a href="http://www.camvine.com">Camvine</a> where we liberate your content from the tyranny of computers to let you splat it onto screens for all to see, we have a few openings. We&#8217;ve got the <a href="http://camvine.com/products/coda/hardware">codapod</a> end of the delivery which is the hardware that pumps out the pixels to your screen, right the way through to the <a href="http://camvine.com/products/coda/webservice">web service</a> which controls the screens and the content.</p>

<p>We are looking for two people, a <a href="http://www.cambridgenetwork.co.uk/vacancies/article/default.aspx?objid=65552">software developer</a> and a <a href="http://www.cambridgenetwork.co.uk/vacancies/article/default.aspx?objid=65554">customer liaison/support/QA</a>.</p>

<p>I can vouch that the software development side is fun and challenging. There is a lot of scope for doing exciting things and coming up with new and clever solutions.</p>

<p>If you&#8217;re interested or know someone else who is interested then get in contact at the addresses in the ads.</p>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2009/12/03/the-great-display-power-saving-debacle/">The Great Display Power Saving Debacle</a>
    </h1>
  
  








  


<time datetime="2009-12-03T00:00:00+00:00" pubdate data-updated="true">Dec 3<span>rd</span>, 2009</time>
</div>

<div class="post-content"><p>We are supposed to be concerned with our power consumption. After all <a href="http://www.latimes.com/business/la-fi-big-screen-tvs19-2009nov19,0,4027697.story">California has enshrined in law</a> restrictions on the power usage of televisions.</p>

<p>Working for a <a href="http://www.camvine.com">digital signage company</a> I have to deal with a lot of displays. The initial hardware platform only had VGA output, great, power saving worked using DPMS. The <a href="http://en.wikipedia.org/wiki/VESA_Display_Power_Management_Signaling">VESA Display Power Management Signaling</a> standard version 1.0 was released in 1993, even since moving from CRTs to the flat screen world we live in nowadays (making some of hsync and vsync options surplus to requirements on new flat screens, but it simply maps to &#8220;off&#8221;). The monitors people used behaved themselves. The next platform we used briefly had DVI and VGA output and monitors that supported those inputs all adhered to the teenage standard.</p>

<p>But this is where problems now creep in. DVI can be plugged into an HDMI port very easily. The current hardware platform has native HDMI so it is fairly obvious to suggest that customers use this rather than the VGA output that is also available.</p>

<p>This is where I stepped through the looking glass. Apparently because HDMI and DVI are electrically equivalent then there is nothing to stop the manufacturer having DPMS support. I was developing thinking that HDMI would be great for users since they would also get audio transport built into the single cable. I kind of assumed DPMS was still working.</p>

<p>I have yet to find a single display that does respect DPMS. Of course most people want to use cheap consumer televisions so they don&#8217;t stand a chance of this support.</p>

<p>The most worrying thing I have found about those cheap consumer displays is that they do supply VGA ports that don&#8217;t even support DPMS. A lot of these displays also have a &#8220;feature&#8221; to power off after a ten minute (or so) period of inactivity and the only way to power it on is to physically press the power button or the remote, it doesn&#8217;t even notice when a signal starts again(!)</p>

<p>There are two possible solutions. One is <a href="http://en.wikipedia.org/wiki/HDMI#CEC">HDMI-CEC</a>, which is Consumer Electronic Control. One or two of the pins (depending on the HDMI version) is essentially a serial port, and this provides the standard for communication on this. This would be good but you need extra chips built into your HDMI output which only one computer has (a Toshiba laptop &#8211; and it only works on Windows&#8230;). Also the even larger problem is that every manufacturer seems to have their own standard, RegzaLink, SIMPLink, VIERAlink, BRAVIAsync, and a myriad of others. If you buy all your equipment from the same manufacturer you will end up with some benefit.</p>

<p>The other solution at least in the digital signage use is to use the RS232 service port for controlling the display. Each monitor tends to have its own way of doing it and can even vary between model numbers. Also it has been heard from the manufacturers that they will be phasing this out and most new TVs don&#8217;t even have it.</p>

<p>In summary? Display power saving used to work for most people, now it doesn&#8217;t. So, it is all well and good reducing the power consumption of the devices but there is a way of removing a lot of power from the equation by switching off the panel when it isn&#8217;t being used. This was a solved problem that has been unsolved by engineering madness. Because some TVs are unable to wake from their power saving state over any connection I ended up having to add a &#8220;power saving&#8221; option that doesn&#8217;t actually save any power&#8230;.</p>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2009/06/30/europython-blogging/">Europython Blogging</a>
    </h1>
  
  








  


<time datetime="2009-06-30T00:00:00+01:00" pubdate data-updated="true">Jun 30<span>th</span>, 2009</time>
</div>

<div class="post-content"><p>And here I am at Europython 2009 in rainy but inhumanly hot Birmingham. I made it for 8am but I am all on my own thanks to a possible hamthrax infected absence.</p>

<p>Interesting stuff from the main introduction. There are over 440 delegates. There are some raffles including the coins designed by Stani using free software. Also they&#8217;re looking for venues for 2011/2012 but it sounds like a hell of a lot of work.</p>

<p>Right, on to my first talk about PyPy.</p>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2009/06/23/europython-2009/">EuroPython 2009</a>
    </h1>
  
  








  


<time datetime="2009-06-23T00:00:00+01:00" pubdate data-updated="true">Jun 23<span>rd</span>, 2009</time>
</div>

<div class="post-content"><p>The <a href="http://www.europython.eu/">EuroPython 2009</a> conference is less than a week away, I have no idea where June went. It should be a great time in sunny Birmingham. I am going to the conference days Tuesday through Thursday.</p>

<p>There are <a href="http://www.europython.eu/talks/timetable/">loads of talks</a> so my brain should be crammed after three days of that. I might also try out doing a lightning talk whilst I am there. although I would have to put some thought into what I&#8217;d talk about.</p>

<p>You can register <a href="http://www.europython.eu/registration/">here</a> with the three conference days costing £190.</p>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2009/06/23/boot-error-when-booting-from-usb/">&#8220;Boot Error&#8221; When Booting From USB</a>
    </h1>
  
  








  


<time datetime="2009-06-23T00:00:00+01:00" pubdate data-updated="true">Jun 23<span>rd</span>, 2009</time>
</div>

<div class="post-content"><p>Some BIOS have problems booting from USB pen drives. This lead to to what I consider an insane discovery, USB flash drives have heads, cylinders, and sectors/tracks, but they are entirely virtual.</p>

<p>What your normally end up with is a prompt saying &#8220;Boot Error&#8221; and nothing else of use. This is because some BIOS are limited to 1024 cylinders so you need to change the geometry of the flash drive.</p>

<p>You can do this in Linux with the following commandline (where sdX is the device which is the usb flash storage):</p>

<pre lang="Bash" colla="+">mkdiskimage -4 /dev/sdX 0 63 62
</pre>


<p>The numbers depend on the size of the USB key as they need to be chosen to get a total number of cylinders less than 1024.</p>

<p>A 1GB stick would be:</p>

<pre lang="Bash" colla="+">mkdiskimage -4 /dev/sdX 0 64 32
</pre>


<p>A 1GB-2GB stick would be:</p>

<pre lang="Bash" colla="+">mkdiskimage -4 /dev/sdX 0 128 32
</pre>


<p>A 2GB-8GB stick would be:</p>

<pre lang="Bash" colla="+">mkdiskimage -4 /dev/sdX 0 255 63
</pre>


<p>Once your geometry is set up you can go ahead and partition your device and use it.</p>
</div>
 </div>


<div id="pagination">
  
    <a class="prev" href="/blog/page/7/">&laquo;Previous</a>
  
  
    <a class="next" href="/blog/page/5/">Next&raquo;</a>
  
</div>
 </div>
    <div id="footer">
  <div class="panels">
    <div class="license">
      <h2>License</h2>
      <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>.
    </div>

    <div class="posts">
      <h2>Recent Posts</h2>
      <ul>
        
          <li>
            <a href="/blog/2013/06/22/rss-feed-moved-to-http-slash-slash-www-dot-fragmentedmemory-dot-com-slash-feed-slash/">RSS Feed Moved To http://www.fragmentedmemory.com/feed/</a>
          </li>
        
          <li>
            <a href="/blog/2013/06/18/new-location-and-new-blog-engine-and-old-content-restored/">New Location &amp; New Blog Engine &amp; Old Content Restored</a>
          </li>
        
          <li>
            <a href="/blog/2013/06/13/joining-microsoft/">Joining Microsoft</a>
          </li>
        
          <li>
            <a href="/blog/2013/06/13/leaving-bromium/">Leaving Bromium</a>
          </li>
        
          <li>
            <a href="/blog/2013/03/05/philip-su-engineering-process-and/">Philip Su - Engineering Process And Philosophy At Facebook</a>
          </li>
        
      </ul>
    </div>

    <div class="posts">
      <h2>Links</h2>
      <a href='https://alpha.app.net/gjb' class='adn-button' target='_blank' data-type='follow' data-width='277' data-height='27' data-user-id='@gjb' data-show-username='1' rel='me'>Follow me on App.net</a><script>(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='//d2zh9g63fcvyrq.cloudfront.net/adn.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'adn-button-js'));</script>
    </div>
  </div>

  <p class="powered">
    Powered by <a href="http://octopress.org">Octopress</a> and <a href="https://github.com/iwinux/compbits">Compbits</a>
  </p>
</div>

  </div> <!-- #wrapper end -->

  

  


  

  

  
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


</body>
</html>
