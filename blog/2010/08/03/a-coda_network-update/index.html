
<!DOCTYPE HTML>
<html lang="en-gb">
<head>
  <meta charset="UTF-8">
  <title>Fragmented Memory</title>

  <meta name="author" content="Garry Bodsworth">
  
  <meta name="description" content="A Coda_network Update Aug 3rd, 2010 I have been making a slow trickle of commits to coda_network as I need various features. The httplib.py and &hellip;">
  
  

  <link rel="canonical" href="http://www.fragmentedmemory.com/blog/2010/08/03/a-coda_network-update">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/feed/" rel="alternate" title="Fragmented Memory" type="application/atom+xml">
</head>
  
<body class="default">
  <div id="wrapper">
    <div id="header">
  <h1><a href="/">Fragmented Memory</a></h1>
  
    <p>Garry Bodsworth's Blog (formerly Garry's Bit Patterns &amp; Programmer's Log)</p>
  
</div>
<ul id="social-links">
  
    <li><a class="rss" href="/feed/" title="RSS">RSS</a></li>
  
  
  
  
    <li><a class="twitter" href="http://twitter.com/garrybodsworth" title="Twitter">Twitter</a></li>
  
  
    <li><a class="github" href="https://github.com/garrybodsworth" title="GitHub">GitHub</a></li>
  
  
  
    <li><a class="linkedin" href="http://www.linkedin.com/in/garrybodsworth">LinkedIn</a></li>
  
  
  
  
    <li><a class="pinboard" href="https://pinboard.in/u:garrybodsworth" title="Pinboard">Pinboard</a></li>
  
</ul>
<div class="clear"></div>
<ul id="nav">
  
    <li> <a href="/">blog</a> </li>
  

  
    <li><a href="/blog/archives">archives</a></li>
  

  
    <li><a href="/about">about</a></li>
  
</ul>

    <div id="main"> <div class="post-header">
  
    <h1 class="post-title">A Coda_network Update</h1>
  
  








  


<time datetime="2010-08-03T00:00:00+01:00" pubdate data-updated="true">Aug 3<span>rd</span>, 2010</time>
</div>

<div class="post-content"><p>I have been making a slow trickle of commits to <a href="http://github.com/garrybodsworth/coda_network">coda_network</a> as I need various features. The httplib.py and urllib2.py have been used in the field for a while in a variety of networks and I am pleased with how it has gone (now that means I need to get these changes upstream when I have a chance).</p>

<p>So what changes have gone in?<br/>
* A skeletal mock proxy server that can fake HTTP and HTTPS requests. This will perform the basis of unit testing.<br/>
* Fix a bit where TCP keepalive failed to happen over HTTPS.<br/>
* Implemented MD5-sess digest authentication which seems to be what IIS Windows servers use.<br/>
* Added an authentication handler for OAuth.</p>

<p>The authentication handler for OAuth was the most work. Essentially I had to extract the OAuth logic from <a href="http://github.com/simplegeo/python-oauth2">oauth2</a> and remove all the close coupling with httplib. This then means you can have an OAuth handler in the urllib2 world of Python and do it through proxies and the suchlike. Your server does need to return a 401 rather than the ones I have seen that get a 500 internal server error when the request is made without authorisation.</p>

<p>To get it working I cheated and reused username and password because they have little meaning in the OAuth world. So you end up with something like this (you can skip the token part if you don&#8217;t have it yet):<br/>
`<br /></p>

<pre><code>password_mgr = urllib2.HTTPPasswordMgrWithDefaultRealm()&lt;br /&gt;
password_mgr.add_password(None,&lt;br /&gt;
                          'http://oauthprotected.com',&lt;br /&gt;
                          KeySecret('consumer_key', 'consumer_secret'),&lt;br /&gt;
                          KeySecret('token', 'token_secret'),&lt;br /&gt;
                          )&lt;br /&gt;
auth_handler = oauth_auth.HTTPOauthAuthHandler(password_mgr)&lt;br /&gt;
</code></pre>

<p>`</p>

<p>It is all done entirely in HTTP headers and there is no option for GET or POST parameters.</p>
</div>


<div class="post-single">
  <div class="post-meta">
    

<span class="categories">
  Categories:
  
    <a class='category' href='/blog/categories/uncategorized/'>Uncategorized</a>
  
</span>


    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://www.fragmentedmemory.com/blog/2010/08/03/a-coda_network-update/" data-via="garrybodsworth" data-counturl="http://www.fragmentedmemory.com/blog/2010/08/03/a-coda_network-update/" >Tweet</a>
  
  
  
</div>

    
  </div>
  <div class="clear"></div>

  
</div>
 </div>
    <div id="footer">
  <div class="panels">
    <div class="license">
      <h2>License</h2>
      <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>.
    </div>

    <div class="posts">
      <h2>Recent Posts</h2>
      <ul>
        
          <li>
            <a href="/blog/2013/06/22/rss-feed-moved-to-http-slash-slash-www-dot-fragmentedmemory-dot-com-slash-feed-slash/">RSS Feed Moved To http://www.fragmentedmemory.com/feed/</a>
          </li>
        
          <li>
            <a href="/blog/2013/06/18/new-location-and-new-blog-engine-and-old-content-restored/">New Location &amp; New Blog Engine &amp; Old Content Restored</a>
          </li>
        
          <li>
            <a href="/blog/2013/06/13/joining-microsoft/">Joining Microsoft</a>
          </li>
        
          <li>
            <a href="/blog/2013/06/13/leaving-bromium/">Leaving Bromium</a>
          </li>
        
          <li>
            <a href="/blog/2013/03/05/philip-su-engineering-process-and/">Philip Su - Engineering Process And Philosophy At Facebook</a>
          </li>
        
      </ul>
    </div>

    <div class="posts">
      <h2>Links</h2>
      <a href='https://alpha.app.net/gjb' class='adn-button' target='_blank' data-type='follow' data-width='277' data-height='27' data-user-id='@gjb' data-show-username='1' rel='me'>Follow me on App.net</a><script>(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='//d2zh9g63fcvyrq.cloudfront.net/adn.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'adn-button-js'));</script>
    </div>
  </div>

  <p class="powered">
    Powered by <a href="http://octopress.org">Octopress</a> and <a href="https://github.com/iwinux/compbits">Compbits</a>
  </p>
</div>

  </div> <!-- #wrapper end -->

  

  


  

  

  
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


</body>
</html>
