
<!DOCTYPE HTML>
<html lang="en-gb">
<head>
  <meta charset="UTF-8">
  <title>Fragmented Memory</title>

  <meta name="author" content="Garry Bodsworth">
  
  <meta name="description" content="OpenELEC - New Distro for Media Centres Oct 20th, 2011 I saw that a project called OpenELEC (Open Embedded Linux Entertainment Centre) got released &hellip;">
  
  

  <link rel="canonical" href="http://www.fragmentedmemory.com/posts/3">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/feed/" rel="alternate" title="Fragmented Memory" type="application/atom+xml">
</head>
  
<body class="default">
  <div id="wrapper">
    <div id="header">
  <h1><a href="/">Fragmented Memory</a></h1>
  
    <p>Garry Bodsworth's Blog (formerly Garry's Bit Patterns &amp; Programmer's Log)</p>
  
</div>
<ul id="social-links">
  
    <li><a class="rss" href="/feed/" title="RSS">RSS</a></li>
  
  
  
  
    <li><a class="twitter" href="http://twitter.com/garrybodsworth" title="Twitter">Twitter</a></li>
  
  
    <li><a class="github" href="https://github.com/garrybodsworth" title="GitHub">GitHub</a></li>
  
  
  
    <li><a class="linkedin" href="http://www.linkedin.com/in/garrybodsworth">LinkedIn</a></li>
  
  
  
  
    <li><a class="pinboard" href="https://pinboard.in/u:garrybodsworth" title="Pinboard">Pinboard</a></li>
  
</ul>
<div class="clear"></div>
<ul id="nav">
  
    <li> <a href="/" class="current">blog</a> </li>
  

  
    <li><a href="/blog/archives">archives</a></li>
  

  
    <li><a href="/about">about</a></li>
  
</ul>

    <div id="main"> 

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2011/10/20/openelec-new-distro-for-media-centres/">OpenELEC - New Distro for Media Centres</a>
    </h1>
  
  








  


<time datetime="2011-10-20T21:17:00+01:00" pubdate data-updated="true">Oct 20<sup>th</sup>, 2011</time>
</div>

<div class="post-content"><div class='post'>
I saw that a project called <a href="http://www.openelec.tv/">OpenELEC</a> (Open Embedded Linux Entertainment Centre) got released released recently.&nbsp; What is interesting about it is not so much the fact that it is a fast booting XBMC distribution, but the fact that it is an embedded Linux system for x86 platforms with minimal size and uses the latest components.<br /><br />I can vouch for the most important thing when dealig with media is having the latest graphics dependencies on Linux.&nbsp; You tend not to have long-lived stable releases and most issues and advances are done in the day-to-day development.<br /><br />The source code is available on Github <a href="https://github.com/OpenELEC/OpenELEC.tv">here</a>.&nbsp; Going through I can see it has Python, GTK+, and Python gobject bindings, Linux 3.1rc10 kernel and lots more.&nbsp; Even though it is a cut-down minimal system it doesn&#8217;t lack handy things like ssh and a text editor.<br /><br />The final images are a mere 100MB or there about in size.&nbsp; There are scripts to create the USB install key and it even has an automated update system.&nbsp; There are optimised builds for ION and AMD Fusion as well as a few other platforms.<br /><br />If you want an XBMC computer then I can think of more heavyweight ways to get it, but if you want it to boot in 10 seconds and you don&#8217;t need to cusomise it too much then this would be a really good choice.<br /><br />To me it looks like an ideal platform for trying out different media type applications (say kiosks or other media centres) with not a huge amount of code as the base system looks pretty solid.&nbsp; I reckon something like Clutter&#8217;s <a href="http://media-explorer.github.com/">Media Explorer</a> could be quite good on it.</div>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2011/09/26/pycon-uk-2011-great-conference/">PyCon UK 2011 - Great Conference</a>
    </h1>
  
  








  


<time datetime="2011-09-26T21:21:00+01:00" pubdate data-updated="true">Sep 26<sup>th</sup>, 2011</time>
</div>

<div class="post-content"><div class='post'>
Now with EuroPython being held outside the UK, the PyCon UK takes on more significance.&nbsp; Run by the same guys and now relocated to Coventry this year was a triumph.&nbsp; Something like 200 people attended for the weekend log conference which is pretty impressive.<br /><br />The venue was excellent.&nbsp; The most important aspect was all meals were supplied at the venue (and were all very tasty).&nbsp; This meant that people tended not to drift off and hopefully that helped the mingling.&nbsp; Some of the rooms were a little small but nobody seemed to forsee how well attended the weekend would be with lots of last minute tickets.<br /><br />The topic that dominated the entire conference was computing and education.&nbsp; Specifically the useless nature of ICT courses and the complete lack of the next generation of coders coming through.&nbsp; The obvious technology on show and being discussed was RaspberryPi.&nbsp; There was also the BBC CodeLab host attempting to evoke those old feelings of the BBC Model B.&nbsp; Basically the conclusion comes down to there is no will in government for changing the nature of computing in schools and it will require hackers in number making the changes piece by piece themselves.<br /><br />The Coding Dojo was a lot of fun using the task of Maze Generation.&nbsp; We managed to lash enough together five minutes form the end and I think we surprised ourselves by it working.&nbsp; Also the web development open forum was good, maybe I spoke too much in that&#8230;.&nbsp; and I managed to get a demo of <a href="http://camvine.com/">Camvine</a> in there.&nbsp; There was also three thought-provoking and entertaining keynotes.<br /><br />As always the people there made the conference.&nbsp; The team who ran it all did a sterling job, even better than their previous EuroPythons.&nbsp; Team 4 in the Code Dojo did a great bit of work, Matt, Safe, Adrian, and Menno.&nbsp; I also got to speak to the keynote speaker Allison Randal at the meal, in fact the whole table was entertaining.<br /><br />So my recommendation, even if you don&#8217;t use Python much, is to go to PyCon UK next year because I am pretty sure you will learn something or meet some really interesting people.</div>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2011/08/28/raspberry-pi-trojan-horse/">Raspberry Pi - the Trojan Horse?</a>
    </h1>
  
  








  


<time datetime="2011-08-28T20:42:00+01:00" pubdate data-updated="true">Aug 28<sup>th</sup>, 2011</time>
</div>

<div class="post-content"><div class='post'>
The <a href="http://www.raspberrypi.org/">Raspberry Pi</a> project has got a lot of coverage today thanks to the <a href="http://www.guardian.co.uk/technology/2011/aug/28/ict-changes-needed-national-curriculum">article in the Guardian</a> written by <a href="http://memex.naughtons.org/">John Naughton</a>.<br /><br />The fundamental problem has never been the lack of cheap hardware.  Even in this day and age it is not the lack of quality freely available tools.&nbsp; A kid who has the propensity to be a hacker nowadays would invariably have Linux installed with the myriad of tools available, and also doing that they would have the knowledge it should work fairly easy on other computers running roughly the same operating system.<br /><br />The Raspberry Pi is attempting to invoke the feeling of the BBC Micro in an attempt to get kids programming again, because in the near future we are going to be in a very precarious situation with our engineering ability in this country.<br /><br />First of all why did the BBC Micro succeed? It is very hard to compare to today with the abundance of computing hardware just in your pocket.&nbsp; Part of it was almost every classroom across the land had one of these and the children who could work out how to operate them hunted 1s and 0s in packs.&nbsp; There was a communal aspect to it as the children would have to share, listen, and take it in turns.&nbsp; Also, there was the TV programme <a href="http://en.wikipedia.org/wiki/Micro_Live">Micro Live</a>, which was needed to get a chunk of publicity.<br /><br />My first programming was done on BBC Micros at school in the East End of London and at friends houses as we couldn&#8217;t afford one at home. So, I for one know their importance and probably a majority of my friends and colleagues had similar start.<br /><br />When I was at University Linux was just starting to gain some traction and the work of the FSF got us GCC and the mix of other tools.&nbsp; But on Windows I was still trying to use DJGPP and there was no chance of getting more complex things working with an open (free and Free) toolchain.&nbsp; Children coming up in that age must consider it the computing Dark Ages.<br /><br />So I come back to my first statement that cheap hardware has never been the problem.&nbsp; The people getting excited about it are 30+ developers like me who think - &#8220;Oooooh, cheap commodity ARM platform, that I can hack in lots of ways&#8221;.&nbsp; My immediate thought was to make it into an immensely cheap network connected digital signage system.&nbsp; And this is probably because ARM is still a minefield and a static and well supported platform would be desirable.<br /><br />I am not trying to negate the good work done by Raspberry Pi as it could be amazing if it is the Trojan Horse.&nbsp; What do I mean by that?&nbsp; The hardware becomes the makeweight for all the real important stuff that needs to happen if we are truly going to educate the next generation of programmers.<br /><br />What is needed?&nbsp; Community, publicity, documentation and traction.&nbsp; Community because this goes beyond the single classroom of my youth.&nbsp; You need IRC, social networking and tools for more permanent sharing (like <a href="http://github.com/">Github</a> and <a href="https://gist.github.com/">Gist</a>).&nbsp; This then ties into documentation, it would need to be good up front but also allow for the people to evolve it, so much like a wiki.<br /><br />Just social media publicity would not be enough, you would really need a TV programme to generate it, but then this is where the social media would tie in.&nbsp; For the programme they would have to show the users best contributions so there is an incentive to produce and produce something good.&nbsp; After all how many people sent a picture into <a href="http://en.wikipedia.org/wiki/Hartbeat">Hartbeat</a> in the hope of getting into the gallery? It&#8217;s the closest computing could get to the X-Factor&#8230;<br /><br />The most important part will always be changing the educational system to get children learning how computers to make computers work for them rather than simply going through the commercial Word Processor/Spreadsheet operating.&nbsp; I suppose this is where the documentation does come in, but I think there will need to be more.&nbsp; If someone could show educators a curriculum that they could prove worked then that might get the traction required.&nbsp; That would be a tough proposition and also I am unsure about whether there are enough technical skills in the educational sector to deploy such a thing.&nbsp; Maybe it would require people from industry coming in and mentoring&#8230; <br /><br />In the end I am hoping that the Raspberry Pi hardware is the Trojan Horse for something much more fundamental.</div>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2011/08/26/linux-at-20/">Linux at 20</a>
    </h1>
  
  








  


<time datetime="2011-08-26T08:32:00+01:00" pubdate data-updated="true">Aug 26<sup>th</sup>, 2011</time>
</div>

<div class="post-content"><div class='post'>
If it didn&#8217;t exist I somehow think computing would be a much less fun place and I probably wouldn&#8217;t be able to do my job so well.<br /><br /><a href="http://www.linuxfoundation.org/20th/">Linux Foundation</a><br /><a href="http://www.linuxfoundation.org/ 20th" target="_blank"><img src="http://www.linuxfoundation.org/ 20th/images/lf_linux20_webbadge.png" width="300" height="250" alt="I'll be celebrating 20 years of Linux with The Linux Foundation!" border="0"></a></div>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2011/08/24/pycon-uk-2011/">Pycon UK 2011</a>
    </h1>
  
  








  


<time datetime="2011-08-24T22:25:00+01:00" pubdate data-updated="true">Aug 24<sup>th</sup>, 2011</time>
</div>

<div class="post-content"><div class='post'>
Unfortunately I was unable to make it to EuroPython 2011 due to its location (no longer being in Birmingham).&nbsp; The good news is that the same guys who ran Europython in Birmingham have announced <a href="http://pyconuk.org/">Pycon UK</a> in Coventry.<br /><br />For the reasonable price of £95 you get two days of Python goodness.&nbsp; As their website says:<br /><blockquote>                     <br />Sessions will include testing, a code clinic,  Django, PyPy, XML, Design and Graphical Programming. There will be an  unscheduled room for dynamic talks and time allocated for sprints. The  weekend will also feature the return of our ever boisterous conference  dinner!</blockquote>I&#8217;ve paid for my ticket already and Python events are always educational and entertaining.</div>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2011/08/23/new-github-project-pyxlib-ctypes/">New Github Project - Pyxlib-ctypes</a>
    </h1>
  
  








  


<time datetime="2011-08-23T21:33:00+01:00" pubdate data-updated="true">Aug 23<sup>rd</sup>, 2011</time>
</div>

<div class="post-content"><div class='post'>
I had written a pyrex based binding to some elements of Xlib, but I decided to make it pure python to avoid the compilation step.&nbsp; Luckily a kind person had created pyxlib-ctypes <a href="http://code.google.com/p/pyxlib-ctypes/">http://code.google.com/p/pyxlib-ctypes/</a> which is a pure Python binding to the underlying X functions.<br /><br />I needed a few more features due to XComposite for writing crazy desktop compositors in pure Python and also some XFixes functionality so we can really hide the mouse cursor.<br /><br />As such I am publishing my amendments to it on Github - you can check it out here: <a href="https://github.com/garrybodsworth/pyxlib-ctypes">https://github.com/garrybodsworth/pyxlib-ctypes</a> it literally has the bare minimum I needed and could probably be extended for greater coverage.&nbsp; It is used in production and seems to be working very happily.</div>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2011/08/23/resurrection/">Resurrection!</a>
    </h1>
  
  








  


<time datetime="2011-08-23T21:20:00+01:00" pubdate data-updated="true">Aug 23<sup>rd</sup>, 2011</time>
</div>

<div class="post-content"><div class='post'>
It&#8217;s aliiiiiive!<br /><br />After a few years of hosting my own blog on http://programmerslog.com I have come back to Blogger.&nbsp; This unfortunately was caused by losing the domain which is pretty sad&#8230;.&nbsp; I have a back up of the few hundred blog posts in a SQL dump but I doubt I will find the energy to extract them(!)<br /><br />What will be on this blog now?&nbsp; Any projects I publish on Github, lots of Python, Linux, coding, and probably my random artistic scribblings.<br /><br />I must say Blogger is looking rather swish nowadays, part of the reason to use Wordpress was for the features, but now I can do pretty much what I want here.&nbsp; Also I don&#8217;t have to worry about renewing my domain subscriptions or doing software updates&#8230;<br /><br />I&#8217;ve reconfigured all my feeds to point to this blog since it is the only active one.<br /> <br />Now I just have to actually write some content&#8230;</div>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2011/01/09/getting-more-battery-life-out-of-a-linux-laptop/">Getting More Battery Life Out of a Linux Laptop</a>
    </h1>
  
  








  


<time datetime="2011-01-09T00:00:00+00:00" pubdate data-updated="true"></time>
</div>

<div class="post-content"><p>On my ASUS UL20A out of the box power management is pretty good but it still does not reach the heady climbs of Windows.  In running [powertop][1] it gave a lot of useful suggestions like SATA, soundcard and USB, but when you apply these you only get it for that session.  You need some way of making these power saving settings permanent.</p>

<p>Here are a few power management scripts that have increased my battery life by about 20-40% as a rough estimate.  The best way to increase battery life dramatically is to reduce the brightness of your monitor which obviously diminishes the usefulness of your display at a certain point.</p>

<p>Here are the files you need to create (all derived from [this forum post][2]).</p>

<p><strong>vm_dirty_writeback</strong><br/>
`<br />
[sourcecode language=&ldquo;bash&rdquo;]<br /></p>

<h1>!/bin/sh</p></h1>

<p>path_dwc=&#8221;/proc/sys/vm/dirty_writeback_centisecs&#8221;<br />
val=500</p>


<p>case &#8220;$1&#8221; in<br />
    true)<br />
        echo &#8220;**VM dirty writeback 15 seconds&#8221;<br />
        val=1500<br />
        ;;<br />
    false)<br />
        echo &#8220;**VM dirty writeback 5 seconds&#8221;<br />
        val=500<br />
        ;;<br />
esac</p>


<p># 5 seconds on AC, 15 seconds on battery</p>


<p>if [ -w &#8220;$path_dwc&#8221; ] ; then<br />
    echo $val > $path_dwc<br />
fi</p>


<p>exit 0<br />
[/sourcecode]<br />
`

**link\_pm\_policy**  
`<br />
[sourcecode language=&#8221;bash&#8221;]<br />
#!/bin/sh</p>


<p>path_host0=&#8221;/sys/class/scsi_host/host0/link_power_management_policy&#8221;<br />
path_host1=&#8221;/sys/class/scsi_host/host1/link_power_management_policy&#8221;<br />
path_host2=&#8221;/sys/class/scsi_host/host2/link_power_management_policy&#8221;<br />
path_host3=&#8221;/sys/class/scsi_host/host3/link_power_management_policy&#8221;<br />
val=max_performance</p>


<p>case &#8220;$1&#8221; in<br />
    true)<br />
        echo &#8220;**lpm policy powersave ON&#8221;<br />
        val=min_power<br />
        ;;<br />
    false)<br />
        echo &#8220;**lpm policy powersave OFF&#8221;<br />
        val=max_performance<br />
        ;;<br />
esac</p>


<p># max_performance on AC min_power on battery</p>


<p>if [ -w &#8220;$path_host0&#8221; ] ; then<br />
    echo $val > $path_host0<br />
fi</p>


<p>if [ -w &#8220;$path_host1&#8221; ] ; then<br />
    echo $val > $path_host1<br />
fi</p>


<p>if [ -w &#8220;$path_host2&#8221; ] ; then<br />
    echo $val > $path_host2<br />
fi</p>


<p>if [ -w &#8220;$path_host3&#8221; ] ; then<br />
    echo $val > $path_host3<br />
fi</p>


<p>exit 0<br />
[/sourcecode]<br />
`

**snd_suspend**  
`<br />
[sourcecode language=&#8221;bash&#8221;]<br />
#!/bin/sh</p>


<p>path_dwc=&#8221;/sys/module/snd_hda_intel/parameters/power_save&#8221;<br />
val=1</p>


<p>case &#8220;$1&#8221; in<br />
    true)<br />
        echo &#8220;**Intel HD sound suspend&#8221;<br />
        val=1<br />
        ;;<br />
    false)<br />
        echo &#8220;**Intel HD sound on power&#8221;<br />
        val=0<br />
        ;;<br />
esac</p>


<p># 5 seconds on AC, 15 seconds on battery</p>


<p>if [ -w &#8220;$path_dwc&#8221; ] ; then<br />
    echo $val > $path_dwc<br />
fi</p>


<p>exit 0<br />
[/sourcecode]<br />
`

**network_powersave**  
`<br />
[sourcecode language=&#8221;bash&#8221;]<br />
#!/bin/sh</p>


<p>if [ &#8220;$1&#8221; = &#8220;true&#8221; ]; then<br />
            iwconfig wlan0 power on<br />
fi</p>


<p>if [ &#8220;$1&#8221; = &#8220;false&#8221; ]; then<br />
            iwconfig wlan0 power off<br />
fi</p>


<p>exit 0<br />
[/sourcecode]<br />
`

**usb_autosuspend**  
`<br />
[sourcecode language=&#8221;bash&#8221;]<br />
#!/bin/bash<br />
if [ &#8220;$1&#8221; = &#8220;true&#8221; ]; then</p>


<p>  for i in /sys/bus/usb/devices/*/power/level; do<br />
    [ &#8220;$(cat $i)&#8221; = &#8220;auto&#8221; ] && continue<br />
    echo &#8220;auto&#8221; > $i<br />
  done</p>


<p>  for i in /sys/bus/usb/devices/*/power/autosuspend; do<br />
    [ &#8220;$(cat $i)&#8221; -ge 0 2>/dev/null ] && continue<br />
    echo &#8220;2&#8221; > $i<br />
  done</p>


<p><p>fi<br />
[/sourcecode]<br />
`</p>

<p>Then do:</p>

<ul>
<li>Put all the files above in a directory and cd into it.</li>
<li>chmod 755 *</li>
<li>sudo install * /usr/lib/pm-utils/power.d/</li>
<li>Do a reboot here.</li>
</ul>


<p>You can check how it is running by looking at the log in /var/log/pm-powersave.log</p>

<p> [1]: <a href="http://www.lesswatts.org/projects/powertop/">http://www.lesswatts.org/projects/powertop/</a>
 [2]: <a href="http://ubuntuforums.org/showthread.php?t=1326333">http://ubuntuforums.org/showthread.php?t=1326333</a></p>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2011/01/09/asus-ul20a-hints-and-tips-for-running-linux/">Asus UL20A &#8211; Hints and Tips for Running Linux</a>
    </h1>
  
  








  


<time datetime="2011-01-09T00:00:00+00:00" pubdate data-updated="true"></time>
</div>

<div class="post-content"><p>My MacBook Pro developed the <a href="http://support.apple.com/kb/TS2377">nVidia graphics failure problem</a> and I got the motherboard replaced, it has never been the same since and when I asked I basically had no warranty for it. So after three-and-a-half years I decided to buy myself a new laptop. Lacking the riches required for another Apple I decided to go where I am really most comfortable &#8211; Linux. So after a lot of research and fingers crossing I picked up an <a href="http://www.amazon.com/UL20A-A1-Light-12-1-Inch-Silver-Laptop/dp/B002PAQXAE">Asus UL20A</a> off of eBay for 318 quid including postage.</p>

<p>The specs are as follows:</p>

<ul>
<li>Core2Duo SU7300 (dual core 1.3GHz)</li>
<li>12 inch display at 1366&#215;768</li>
<li>Quoting something like 8 hours battery life.</li>
<li>4GB RAM (upgraded by me for 25 quid)</li>
<li>60GB solid state drive (upgraded by me for 95 quid) &#8211; an OCZ Vertex 2E with the respected Sandisk controller.</li>
</ul>


<p>The point of this post, however, is not to review a piece of hardware, but to get Linux working flawlessly on it.</p>

<p><strong>Linux Mint 10</strong></p>

<p>I decided to use<a href="http://www.linuxmint.com/"> Linux Mint 10</a> (Ubuntu base), this is instead of stock Ubuntu which I find very cluttered on initial install and also requires me to do loads of fiddling to get a normal looking and clean desktop environment.  Linux Mint 10 is based on the latest Ubuntu but presents the user a very nicely set up session after the first install.  The desktop is uncluttered, there is only one panel at the bottom, and theme is head and shoulders above the Ubuntu default.</p>

<p>Linux Mint does have a Debian based edition which I will switch to later but the packages are a lot further behind the latest Ubuntu and since I was going to use some more modern features for the SSD I would have to have done a lot more hacking.</p>

<p><strong>Installing</strong></p>

<p>I partitioned the SSD the following way:</p>

<ul>
<li>256MB ext2 /boot partition</li>
<li>4.1GB /swap partition</li>
<li>15GB btrfs / partition</li>
<li>40GB btrfs /home partition</li>
</ul>


<p>I decided to use btrfs because it is the latest and greatest available file system for Linux.  This means it has things like TRIM support for SSDs and can do cool stuff like snapshots, but this also requires a newer kernel for better support hence not using the Linux Mint Debian Edition.</p>

<p>The ext2 boot partition is required as you can&#8217;t boot directly from btrfs according to the information I found out there.  The swap partition is memory + 100MB for supporting hibernate.  The main partition is separate from the home partition &#8211; <strong>this is very important when you use Ubuntu</strong>.  Because Ubuntu does releases every six months you can attempt upgrades, but I have seen and experienced this failing with catastrophic consequences.  Luckily having a separate home partition means you can tell Ubuntu to reinstall to the main partition but just mount and use you home directory without formatting it.</p>

<p>Installation took me about 10-15 minutes before I was there in my freshly installed desktop.  Now, almost everything works straight out of the box, it is case of tweaking to get some of the more hidden features working.</p>

<p><strong>Two Finger Scrolling</strong></p>

<p>Two finger scrolling on the Synaptics touchpad requires a little bit of tweaking.   Create a file called /usr/share/X11/xorg.conf.d/50-twofingerscroll.conf with the folling contents:<br/>
<code>&lt;br /&gt;
Section "InputClass"&lt;br /&gt;
Identifier "touchpad catchall"&lt;br /&gt;
MatchProduct "SynPS/2 Synaptics TouchPad"&lt;br /&gt;
Option "VertTwoFingerScroll" "on"&lt;br /&gt;
Option "HorizTwoFingerScroll" "on"&lt;br /&gt;
Option "EmulateTwoFingerMinW" "5"&lt;br /&gt;
Option "EmulateTwoFingerMinZ" "48"&lt;br /&gt;
EndSection</code></p>

<p>Then start up<em> gconf-editor</em> and change<em> /desktop/gnome/peripherals/touchpad/scroll_method</em> to the value <em>2</em>.</p>

<p>Now you have two finger scrolling working and also two finger right click!</p>

<p><strong>The LCD Brightness Keys</strong></p>

<p>This requires a small change to your boot settings so that you can use the function keys to set the screen brightness.</p>

<p>Edit <em>/etc/default/grub</em> so that the line with <em>GRUB_CMDLINE_LINUX = &#8220;&#8221;</em> says:<br/>
<code>&lt;br /&gt;
GRUB_CMDLINE_LINUX="acpi_backlight=vendor"</code></p>

<p>Then run <em>sudo update-grub </em>and reboot.</p>

<p><strong>Power Settings</strong></p>

<p>To help improve battery life install powertop by using <em>sudo apt-get install powertop</em> then run <em>sudo powertop</em> and follow its instructions.  You should be able to help squeeze precious minutes out of your battery.</p>

<p><strong>Mistakes</strong></p>

<p>I did attempt installing the latest kernel along with the latest graphics drivers.  This was mainly for graphical hacking and trying out newer btrfs options.  This is a big mistake.  For a start the battery monitoring stops working although I managed to solve that, then shutdown stopped working consistently.  So for all the benefits don&#8217;t bother if you prefer your system to be properly functioning.</p>

<p><strong>What I Did Next&#8230;.</strong></p>

<p>I always use <a href="http://ubuntu-tweak.com/">Ubuntu Tweak</a> and it works on Linux Mint 10.  This allows you to get some more interesting packages and also update to cutting edge versions.</p>

<p>There is something I don&#8217;t like about Google Chrome despite its super-speed, so I always go back to Firefox.  Unfortunately distros currently use 3.6 but I have been using 4.0 for about six months, it is much quicker, better looking and more robust.  Through Ubuntu Tweak enable the Minefield repositories and get it.  Also install the Nightly Tools Addon to help get your Addons all working.</p>

<p>I install ttf-droid fonts normally and switch all my desktop to use that as it gives more space, but for people who don&#8217;t like small fonts you probably should avoid it.</p>

<p>I have also installed and am running the theme from the <a href="http://www.elementary-project.com/">elementary project</a> which gives a less Minty user interface for Linux Mint.  It&#8217;s purely aesthetical, although the elementary Nautilus file browser is much better than the default.</p>

<p><strong>All In All</strong></p>

<p>At the end of it I have a fully working Linux laptop that boots in less than 20 seconds and shuts down in about a second.  It is easy to use and responsive which makes me really happy.  From what I have been trying to work out the ASUS laptops seem to have fairly decent Linux support.</p>

<p>Next up I am going to have to get hacking on <a href="http://www.libimobiledevice.org/">libimobiledevice</a> because I have an iPhone and I would like to avoid running updates via a virtual machine or something.</p>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2010/08/12/python-is-beautifully-over-engineered/">Python Is Beautifully Over-engineered</a>
    </h1>
  
  








  


<time datetime="2010-08-12T00:00:00+01:00" pubdate data-updated="true"></time>
</div>

<div class="post-content"><p>I could have called this &#8220;Don&#8217;t re-invent the wheel&#8221;. Sometimes the Python standard library really surprises me because some bits are very over-engineered, but in a really good way. First time I realised this was when I was working on what became <a href="http://github.com/garrybodsworth/coda_network">coda_network</a> as most people solving the proxy problem and other downloading issues just write a new network library, but there are some really handy base classes to derive from to solve it. Admittedly it did require some bug fixing along the way, but it was kind of worthwhile.</p>

<p>In coda_network I&#8217;ve got a mini proxy using ForkingMixin to do a process per download bypassing a lot of GIL based multithreading pain. I needed some more multi processing support for some shared state and possibly locking. So I started trying to do a MultiprocessingMixIn for the SocketServer/TCPServer/BaseHTTPServer. I thought &#8220;this is easy just rip off the threading one since they share the same interface&#8221;. That worked really well for general use but when I started putting the system under severe load the process cleanup started going wonky.</p>

<p>Eventually I think I got it working using this code:</p>

<pre lang="PYTHON" line="1" file="MultiProcessingMixin.py" colla="+">class MultiprocessingMixIn:
    """Mix-in class to handle each request in a new process."""

    # Decides how process will act upon termination of the
    # main process
    daemon_processes = False

    def process_request_process(self, request, client_address):
        """
        Same as in BaseServer but as a thread.
        In addition, exception handling is done here.
        """
        try:
            # Actually do the request
            self.finish_request(request, client_address)
        except:
            # XXX: will this work with multiprocessing correctly?
            self.handle_error(request, client_address)
        finally:
            # Close the socket request
            self.close_request(request)

    def process_request(self, request, client_address):
        """Start a new thread to process the request."""
        t = multiprocessing.Process(target = self.process_request_process,
                             args=(request, client_address))
        if self.daemon_processes:
            t.daemon = True
        t.start()
        # Now we close the parent request socket because the child process
        # is now responsible for it
        self.close_request(request)
</pre>


<p>The important bit is closing the request in the parent after the child process has started since it takes responsibility for it then.</p>

<pre lang="PYTHON" line="1" colla="+">class ProxyServer(MultiprocessingMixIn, BaseHTTPServer.HTTPServer):
    pass

proxy = ProxyServer(address, HttpResponder)
proxy.serve_forever()
</pre>


<p>I&#8217;ve probably missed a couple of bits (like making sure the handle_error does what is expected) but this is at least a good starting point&#8230;.</p>
</div>
 </div>


<div id="pagination">
  
    <a class="prev" href="4">&laquo;Previous</a>
  
  
    <a class="next" href="2">Next&raquo;</a>
  
</div>
 </div>
    <div id="footer">
  <div class="panels">
    <div class="license">
      <h2>License</h2>
      <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>.
    </div>

    <div class="posts">
      <h2>Recent Posts</h2>
      <ul>
        
          <li>
            <a href="/blog/2014/07/13/slash-dev-slash-summer-talk-security-is-hard/">/dev/summer talk - Security Is Hard</a>
          </li>
        
          <li>
            <a href="/blog/2014/07/13/djugl-talk-the-trojan-unicorn/">DJUGL Talk - The Trojan Unicorn</a>
          </li>
        
          <li>
            <a href="/blog/2014/07/13/back-at-bromium/">Back at Bromium</a>
          </li>
        
          <li>
            <a href="/blog/2013/06/22/rss-feed-moved-to-http-slash-slash-www-dot-fragmentedmemory-dot-com-slash-feed-slash/">RSS Feed Moved To http://www.fragmentedmemory.com/feed/</a>
          </li>
        
          <li>
            <a href="/blog/2013/06/18/new-location-and-new-blog-engine-and-old-content-restored/">New Location &amp; New Blog Engine &amp; Old Content Restored</a>
          </li>
        
      </ul>
    </div>

    <div class="posts">
      <h2>Links</h2>
      <a href='https://alpha.app.net/gjb' class='adn-button' target='_blank' data-type='follow' data-width='277' data-height='27' data-user-id='@gjb' data-show-username='1' rel='me'>Follow me on App.net</a><script>(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='//d2zh9g63fcvyrq.cloudfront.net/adn.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'adn-button-js'));</script>
    </div>
  </div>

  <p class="powered">
    Powered by <a href="http://octopress.org">Octopress</a> and <a href="https://github.com/iwinux/compbits">Compbits</a>
  </p>
</div>

  </div> <!-- #wrapper end -->

  

  


  

  

  
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


</body>
</html>
