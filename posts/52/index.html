
<!DOCTYPE HTML>
<html lang="en-gb">
<head>
  <meta charset="UTF-8">
  <title>Fragmented Memory</title>

  <meta name="author" content="Garry Bodsworth">
  
  <meta name="description" content="Subversion : TortoiseSVN Integration Into Visual Studio.NET 2005 Again Oct 3rd, 2006 Today I discovered the &#8220;Import and Export Settings&#8221 &hellip;">
  
  

  <link rel="canonical" href="http://www.fragmentedmemory.com/posts/52">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/feed/" rel="alternate" title="Fragmented Memory" type="application/atom+xml">
</head>
  
<body class="default">
  <div id="wrapper">
    <div id="header">
  <h1><a href="/">Fragmented Memory</a></h1>
  
    <p>Garry Bodsworth's Blog (formerly Garry's Bit Patterns &amp; Programmer's Log)</p>
  
</div>
<ul id="social-links">
  
    <li><a class="rss" href="/feed/" title="RSS">RSS</a></li>
  
  
  
  
    <li><a class="twitter" href="http://twitter.com/garrybodsworth" title="Twitter">Twitter</a></li>
  
  
    <li><a class="github" href="https://github.com/garrybodsworth" title="GitHub">GitHub</a></li>
  
  
  
    <li><a class="linkedin" href="http://www.linkedin.com/in/garrybodsworth">LinkedIn</a></li>
  
  
  
  
    <li><a class="pinboard" href="https://pinboard.in/u:garrybodsworth" title="Pinboard">Pinboard</a></li>
  
</ul>
<div class="clear"></div>
<ul id="nav">
  
    <li> <a href="/" class="current">blog</a> </li>
  

  
    <li><a href="/blog/archives">archives</a></li>
  

  
    <li><a href="/about">about</a></li>
  
</ul>

    <div id="main"> 

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2006/10/03/subversion-tortoisesvn-integration_03/">Subversion : TortoiseSVN Integration Into Visual Studio.NET 2005 Again</a>
    </h1>
  
  








  


<time datetime="2006-10-03T15:44:00+01:00" pubdate data-updated="true">Oct 3<sup>rd</sup>, 2006</time>
</div>

<div class="post-content"><div class='post'>
Today I discovered the &#8220;Import and Export Settings&#8221; feature in Visual Studio.NET 2005.  This means no more losing settings or having to mess around getting the environment set up again after a rogue installer blitzes all of the settings I had worked so hard to set up.<br /><br />What this means is that later today I will post up a link to a file which will customise Visual Studio.NET 2003 for embedding TortoiseSVN.  You&#8217;ll have icons, toolbars, new menus, and additions to the context menus.  You&#8217;ll end up with some of my other settings like removing all Visual SourceSafe source control commands, and other things I find annoying.  But you will easily use this as a base setting and add your own bits and pieces to it.<br /><br />Garry Bodsworth<br /><br /><span style="font-weight:bold;">Edit: See my next post for links to the settings files and screenshots of teh integration.</span></div>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2006/10/02/wireless-routers-and-linksys-wrt54g/">Wireless Routers and the Linksys WRT54G</a>
    </h1>
  
  








  


<time datetime="2006-10-02T21:59:00+01:00" pubdate data-updated="true">Oct 2<sup>nd</sup>, 2006</time>
</div>

<div class="post-content"><div class='post'>
My dad gave me a Linksys Wireless router (WRT54G) and it looks ug-leeee, so I never used it and bought a more stylish looking one which turned out not to work properly to the point I got so annoyed I threw it away.<br /><br />So I dug out the WRT54G and plugged it in.  It worked flawlessly until today when my two router network decided to eat itself.  Eventually after much resetting I got it all up and running again, but I discovered that with heavy network traffic like P2P (and probably my surfing habits) it can crash due to keeping a record of everything for five days.<br /><br />A quick websearch lead me to the <a href="http://en.wikipedia.org/wiki/WRT54G">Wikipedia Article on the Linksys WRT54G</a> and reading that I realised exactly what I had.  The company had opened up the firmware and there were a variety of open source versions available.  I then read this <a href="http://www.utorrent.com/faq.php#Special_note_for_users_with_Linksys_WRT54G_GL_GS_routers">FAQ for utorrent</a> where it describes what firmware it recommends and how to avoid overloading the router.  Never being afraid of destroying hardware I installed <a href="http://www.thibor.co.uk/">HyperWRT Thibor</a> on the router (there is a decent <a href="http://en.wikipedia.org/wiki/HyperWRT">Wikipedia page for HyperWRT</a> as well).  Once it rebooted I saw how many extra features are in there now.  Needless to say I am buying only Linksys routers from now on&#8230;</div>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2006/10/02/subversion-tortoisesvn-integration/">Subversion : TortoiseSVN Integration Into Visual Studio</a>
    </h1>
  
  








  


<time datetime="2006-10-02T10:35:00+01:00" pubdate data-updated="true">Oct 2<sup>nd</sup>, 2006</time>
</div>

<div class="post-content"><div class='post'>
<span style="font-weight:bold;"><a href="http://garrys-brain.blogspot.com/2007/07/tortoisesvn-and-visual-studio.html">See the update here.</a></span><br /><br />This is the easy method of integrating <a href="http://www.tortoisesvn.net">TortoiseSVN</a> into Visual Studio.NET 2003 and 2005 (and probably Visual Studio 6.0).  I&#8217;ll take it in stages first and show you how to add these useful things to your &#8220;External Tools&#8221; menu.<br /><br />TortoiseSVN is kind enough to provide a decent command-line interface for bringing up the dialogs.  This gives us the ability to add External Tools that will operate on the currently open project in Visual Studio.<br /><br />Here is a script (vbs) that will append the External Tools to the end of your list:<br /><table style="font-size:75%;border: 1px dashed #2f6fab; background-color: #f9f9f9;"><tr><td><pre>'<br />' Create the Subversion External Tools for Visual Studio<br />'<br /><br />' Set the Visual Studio Version Number so we access the correct<br />' part of the registry for External Tools.<br />' Visual Studio.NET      = "7.0"<br />' Visual Studio.NET 2003 = "7.1"<br />' Visual Studio.NET 2005 = "8.0"<br />Dim strVisualStudioVersionNumber<br />strVisualStudioVersionNumber = "8.0"<br /><br />Dim strTortoiseSVNBin<br />strTortoiseSVNBin = "c:\\program files\\TortoiseSVN\\bin\\"<br /><br />' Create the scripting shell object<br />Dim WshShell<br />Set WshShell = WScript.CreateObject("WScript.Shell")<br /><br />' Function to install an external tool<br />function WriteExternalTool( strVersionNumber, _<br />    iToolNumber, _<br />    strTitle, _<br />    strCommandLine, _<br />    strArgs, _<br />    strWorkingDir, _<br />    strSource, _<br />    strOptions)<br /> ' NOTES (from Google Groups):<br /> ' ToolTitle<your tool number>:<br /> '   stores the name of your tool<br /> ' ToolCmd<your tool number>:<br /> '   stores the path to your tool<br /> ' ToolArg<your tool number>: <br /> '   stores the command line arguments for your tool.<br /> '   Set this to a blank string if your tool takes no arguments.<br /> ' ToolDir<your tool number>:<br /> '   stores the initial directory from which your tool<br /> '   should be run.  Set this to a blank string if you don't care where your tool<br /> '   is run from.<br /> ' ToolOpt<your tool number>:<br /> '   stores the settings for the checkboxes at the<br /> '   bottom of the external tools dialog.  The easiest way to determine what<br /> '   value you should set, is to create your tool once manually with the<br /> '   checkboxes set the way you like, and then exit visual studio.  Then look up<br /> '   the value that's written to this regkey.  The value that this registry<br /> '   entries got set to is the value your installer should set. <br /> <br /> Dim strTitleKey, strCommandLineKey, strArgsKey, strWorkingDirKey, strSourceKey, strOptionsKey<br /> ' Construct the keys we will be adding to as strings.  These depend on the number of the tool.<br /> strTitleKey =  "HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\" & _<br />     strVersionNumber & "\External Tools\ToolTitle" & iToolNumber<br /> strCommandLineKey = "HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\" & _<br />     strVersionNumber & "\External Tools\ToolCmd" & iToolNumber<br /> strArgsKey =  "HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\" & _<br />     strVersionNumber & "\External Tools\ToolArg" & iToolNumber<br /> strWorkingDirKey = "HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\" & _<br />     strVersionNumber & "\External Tools\ToolDir" & iToolNumber<br /> strSourceKey =  "HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\" & _<br />     strVersionNumber & "\External Tools\ToolSourceKey" & iToolNumber<br /> strOptionsKey =  "HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\" & _<br />     strVersionNumber & "\External Tools\ToolOpt" & iToolNumber<br /> <br /> ' Write out the contents of an external tool <br /> WshShell.RegWrite strTitleKey, strTitle<br /> WshShell.RegWrite strCommandLineKey, strCommandLine<br /> WshShell.RegWrite strArgsKey, strArgs<br /> WshShell.RegWrite strWorkingDirKey, strWorkingDir<br /> WshShell.RegWrite strSourceKey, strSource<br /> WshShell.RegWrite strOptionskey, strOptions, "REG_DWORD"<br /><br /> ' Update the count of external tools for the benefit of Visual Studio<br /> WshShell.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\" & _<br />     strVersionNumber & _<br />     "\External Tools\ToolNumKeys", _<br />    iToolNumber + 1, _<br />    "REG_DWORD"<br /> <br /> WriteExternalTool = (iToolNumber + 1)<br />end function<br /><br />' Get the number of current external tools as this will tell us where to start the numbering<br />Dim iNumTools<br />iNumTools = WshShell.RegRead( "HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\" & _<br />    strVisualStudioVersionNumber & _<br />    "\External Tools\ToolNumKeys")<br /><br />' Install Subversion Tools<br /><br />' The order is:<br />'   SVN Commit<br />'   SVN Update<br />'   SVN History<br />'   SVN Diff<br />'   SVN Blame<br />'   SVN Revert<br />'   SVN Modifications<br />'   SVN Repository<br />'   SVN Project History<br />'   SVN Settings<br /><br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Commit", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:commit /path:""$(SolutionDir)"" /notempfile", _<br />    "$(SolutionDir)", _<br />    "", _<br />    17)<br /><br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Update", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:update /path:""$(SolutionDir)"" /notempfile", _<br />    "$(SolutionDir)", _<br />    "", _<br />    17)<br />    <br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN History", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:log /path:""$(ItemPath)"" /notempfile", _<br />    "$(ItemDir)", _<br />    "", _<br />    17)<br />    <br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Diff", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:diff /path:""$(ItemPath)"" /notempfile", _<br />    "$(ItemDir)", _<br />    "", _<br />    17)<br /><br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Blame", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:blame /path:""$(ItemPath)"" /notempfile", _<br />    "$(ItemDir)", _<br />    "", _<br />    17)<br /><br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Revert", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:revert /path:""$(SolutionDir)"" /notempfile", _<br />    "$(SolutionDir)", _<br />    "", _<br />    17)<br /><br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Modifications", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:repostatus /path:""$(SolutionDir)"" /notempfile", _<br />    "$(SolutionDir)", _<br />    "", _<br />    17)<br /><br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Repository", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:repobrowser /path:""$(SolutionDir)"" /notempfile", _<br />    "$(SolutionDir)", _<br />    "", _<br />    17)<br /><br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Project History", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:log /path:""$(SolutionDir)"" /notempfile", _<br />    "$(SolutionDir)", _<br />    "", _<br />    17)<br /><br />iNumTools = WriteExternalTool( strVisualStudioVersionNumber, _<br />    iNumTools, _<br />    "SVN Settings", _<br />    strTortoiseSVNBin & "tortoiseproc.exe", _<br />    "/command:settings /path:""$(SolutionDir)"" /notempfile", _<br />    "$(SolutionDir)", _<br />    "", _<br />    17)<br /><br />' Reset the scripting shell object<br />set WshShell = nothing</pre></td></tr></table><br /><a href="http://garry.bodsworth.googlepages.com/SubversionInstall.zip">Download the script from this link</a><br /><br />You can set your Visual Studio version by setting the <span style="font-style: italic;">strVisualStudioVersionNumber</span> variable according to the comment.<br /><br />If your TortoiseSVN is not in the default installation location change the <span style="font-style: italic;">strTortoiseSVNBin </span>variable (making sure you use &#92; as separators).<br /><br />I am not a vbs expert but I tried to make this script as reusable as possible, especially with respect to writing the external tools to the registry.  This should work with any external tools you may want to add via this script.  There are probably some TortoiseSVN features that should be added as well, but I have got by on what is in that script so far.<br /><br />For the next part I will describe how to make a toolbar to access the new External Tools.</div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Adi</div>
<div class='content'>
<a rel="external" href="http://orientinspiration.com/2009/09/oes-tsetnoc.html" rel="nofollow">Oes  Tsetnoc</a> one of the ways in which we can learn seo besides <a rel="external" href="http://duniasoer.com/archives/mengembalikan-jati-diri-bangsa.html" rel="nofollow">Mengembalikan Jati Diri Bangsa</a>.  By participating in the <a rel="external" href="http://mncmakina.com/2009/09/oes-tsetnoc-seo-contest/" rel="nofollow">Oes Tsetnoc</a> or <a rel="external" href="http://ulaznice.info/mengembalikan-jati-diri-bangsa.html" rel="nofollow">Mengembalikan Jati Diri Bangsa</a> we can improve our seo skills. To find more information about <a rel="external" href="http://catatanblogger.info/738688-Oes-Tsetnoc.html" rel="nofollow">Oest Tsetnoc</a> please visit my <a rel="external" href="http://kusukaseo.info/981750-Oes-Tsetnoc-Support.html" rel="nofollow">Oes Tsetnoc</a> pages. And to find more information about <a rel="external" href="http://duniasoer.com" rel="nofollow">Mengembalikan Jati Diri Bangsa</a> please visit my <a rel="external" href="http://catatanblogger.info/464655-Mengembalikan-Jati-Diri-Bangsa.html" rel="nofollow">Mengembalikan Jati Diri Bangsa</a> pages. Thank you So much.</div>
</div>
</div>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2006/10/01/subversion-and-tortoisesvn-programmers/">Subversion and TortoiseSVN - a Programmers Best Friend</a>
    </h1>
  
  








  


<time datetime="2006-10-01T19:29:00+01:00" pubdate data-updated="true">Oct 1<sup>st</sup>, 2006</time>
</div>

<div class="post-content"><div class='post'>
Before you work in industry it is unlikely you ever use any source control.  At Essex Uni we were forced to use RCS (on the command-line) once and it all seemed pretty trivial and pointless.  Most of the time when you go into industry you end up having to use Visual SourceSafe, sure it does a job, but for the most part it is completely useless and scales terribly.<br /><br />Earlier this year I migrated the company I work at (<a href="http://www.ncgraphics.net">NC Graphics</a>) from Visual SourceSafe to Subversion.  I prepared a lot for this doing tons of research to make this transition as seamless as humanly possible, but as these things normally happen time was a serious factor.  Bizarrely it was done ahead of schedule and the benefits were pretty much instantaneous.  Sometimes in IT we beat deadlines(!)<br /><br /><span style="font-weight: bold;">The Migration</span><br /><br />I spent ages reading everything I could find via Google about migrating anything to Subversion.  This was necessary as there was very little covering Visual SourceSafe specifically.  In the end I had to choose the only tool even remotely capable of doing the conversion called <a href="http://vss2svn.tigris.org/">vss2svn</a> and even then there were some compromises that had to be made.  I used the orginal &#8220;legacy&#8221; script from their development repository.  It essentially gets every file you have currently in your source tree and then search each of their histories backwards in time.  This does mean you lose renames and files that have been removed.  The good thing though is that it converts the check-ins into Subversion style atomic commits by grouping them all together by time and user.<br /><br />There is a new version of <a href="http://www.pumacode.org/projects/vss2svn">vss2svn</a> (new website) but it was nowhere near being ready when I was doing this work.  This version actually reconstructs almost everything by reverse-engineering the Visual SourceSafe file format.  If you have archived portions or restored portions I found that it didn&#8217;t work.  It seems to have come a long way since I last looked, but I don&#8217;t think it would have converted our large database with all of its quirks.<br /><br />Back to the original script though&#8230;  To get it to run fast what I did was archive out the areas of SourceSafe we needed and then imported them into a brand new clean instance.  This cut the running time for the script from the test run of 14 days down to less than 2 days.<br /><br /><span style="font-weight: bold;">Using Subversion For Development</span><br /><br />Obviously you have the basic command-line tools for using <a href="http://subversion.tigris.org">Subversion</a> but there is a lot more out there as well.  Internally we use <a href="http://tortoisesvn.net/">TortoiseSVN</a> and that is about it.  Most people are looking at loads of other options, but once you use TortoiseSVN you don&#8217;t need anything else, it only takes about a day, maybe two to realise this.  Without hyperbole I can say TortoiseSVN ranks right up there as one of the greatest gifts to developers ever made.<br /><br />To make it even more useful though I did a little work to integrate it into Visual Studio.NET (2003 and 2005).  It is actually really simple to do because TortoiseSVN provides us with a commandline interface that can display the dialogs.  In the next couple of days I will give complete instructions how to set this up and even describe how to set it all up on a toolbar like I currently have it.  I&#8217;ll also cover all the clients I checked out in the course of the migration.</div>
</div>
 </div>

  
  <div class="post"> <div class="post-header">
  
    <h1 class="post-title">
      <a href="/blog/2006/10/01/first-post/">First Post</a>
    </h1>
  
  








  


<time datetime="2006-10-01T16:52:00+01:00" pubdate data-updated="true">Oct 1<sup>st</sup>, 2006</time>
</div>

<div class="post-content"><div class='post'>
I suppose at the moment I just need an outlet for all these computer-type things going round in my head.  I mainly specialise in C++ and was once known (and probably still known) as a GUI specialist.  I&#8217;ve done all kinds of random things like setting up a company-wide bug database and migrating a Visual SourceSafe (VSS) &#8220;database&#8221; to a Subversion repository.<br /><br />I tend to read loads of programming stuff in my spare time and I think should put my money where my mouth is and provide some source code on the Internet that may be of use to someone.  On numerous occasions in my programming career I have encountered bits and pieces that even Google couldn&#8217;t rescue me from, and I know for a fact MSDN help is a chocolate teapot.  I like it when the building blocks are out there and it gives you just enough to build your own solution.<br /><br />So in the future if you are interested, you can look forward to ramblings on C++, Open Source libraries that I encounter, MFC, Win32, user interface design, Open Source programs that make life easier, STL library, Boost library, template metaprogramming, code design, Python, and more.<br /><br />Thanks for listening, now it is time to get some real content&#8230;<br /><br />Garry Bodsworth</div>
</div>
 </div>


<div id="pagination">
  
  
    <a class="next" href="51">Next&raquo;</a>
  
</div>
 </div>
    <div id="footer">
  <div class="panels">
    <div class="license">
      <h2>License</h2>
      <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>.
    </div>

    <div class="posts">
      <h2>Recent Posts</h2>
      <ul>
        
          <li>
            <a href="/blog/2014/07/13/slash-dev-slash-summer-talk-security-is-hard/">/dev/summer talk - Security Is Hard</a>
          </li>
        
          <li>
            <a href="/blog/2014/07/13/djugl-talk-the-trojan-unicorn/">DJUGL Talk - The Trojan Unicorn</a>
          </li>
        
          <li>
            <a href="/blog/2014/07/13/back-at-bromium/">Back at Bromium</a>
          </li>
        
          <li>
            <a href="/blog/2013/06/22/rss-feed-moved-to-http-slash-slash-www-dot-fragmentedmemory-dot-com-slash-feed-slash/">RSS Feed Moved To http://www.fragmentedmemory.com/feed/</a>
          </li>
        
          <li>
            <a href="/blog/2013/06/18/new-location-and-new-blog-engine-and-old-content-restored/">New Location &amp; New Blog Engine &amp; Old Content Restored</a>
          </li>
        
      </ul>
    </div>

    <div class="posts">
      <h2>Links</h2>
      <a href='https://alpha.app.net/gjb' class='adn-button' target='_blank' data-type='follow' data-width='277' data-height='27' data-user-id='@gjb' data-show-username='1' rel='me'>Follow me on App.net</a><script>(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='//d2zh9g63fcvyrq.cloudfront.net/adn.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'adn-button-js'));</script>
    </div>
  </div>

  <p class="powered">
    Powered by <a href="http://octopress.org">Octopress</a> and <a href="https://github.com/iwinux/compbits">Compbits</a>
  </p>
</div>

  </div> <!-- #wrapper end -->

  

  


  

  

  
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


</body>
</html>
